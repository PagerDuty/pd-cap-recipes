#!/usr/bin/env ruby
# This scripts prints all the migrations that have been run for a rails project.

require 'mysql'
require 'yaml'
require 'erb'

env = ENV['RAILS_ENV'] || 'development'
db_info = YAML.load(ERB.new(File.read(File.join('.', 'config/database.yml'))).result)[env]

args = %w(host username password database port sock flag).map { |var| db_info[var] }
driver = Mysql.new(*args)

sql = "SELECT * FROM schema_migrations"
migrations = []
driver.query(sql) do |res|
  res.each do |row|
    migrations << row.first
  end
end

puts migrations

